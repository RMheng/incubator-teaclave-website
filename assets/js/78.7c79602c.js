(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{462:function(t,e,a){"use strict";a.r(e);var s=a(27),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"the-world-of-forked-crates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-world-of-forked-crates"}},[t._v("#")]),t._v(" The World of Forked crates")]),t._v(" "),a("p",[t._v('We created a "super repo" at '),a("a",{attrs:{href:"https://github.com/dingelish/sgx-world",target:"_blank",rel:"noopener noreferrer"}},[t._v("dingelish/sgx-world"),a("OutboundLink")],1),t._v(", which includes all the forked repos as git submodules.")]),t._v(" "),a("p",[t._v('We created a "dumb crate" '),a("a",{attrs:{href:"https://github.com/dingelish/sgx-world/tree/master/dumb-all",target:"_blank",rel:"noopener noreferrer"}},[t._v("dumb-all"),a("OutboundLink")],1),t._v(" to help us maintain the world of forked crates. Each dependency of dumb-all is a valid crate in Rust-SGX ecosystem. The enabled feature set is likely to be the universe of supported feature set. Exceptions exist in a couple of crates, where there are conflict features.")]),t._v(" "),a("p",[t._v("Generally speaking, to use a forked crate, simply use the following statement:")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("wasmi")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("git")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/mesalock-linux/wasmi-sgx"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("No need to config the branch in most cases. Only a few of the forked crates use specific branches.")]),t._v(" "),a("h2",{attrs:{id:"tagging"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tagging"}},[t._v("#")]),t._v(" Tagging")]),t._v(" "),a("p",[t._v("As of today, Oct 23 2019, cargo still has problem on git dependencies. The issue is "),a("a",{attrs:{href:"https://github.com/rust-lang/cargo/issues/7497",target:"_blank",rel:"noopener noreferrer"}},[t._v("cargo #7497"),a("OutboundLink")],1),t._v(". It leads to a dependency hell if the Cargo.toml looks like:")]),t._v(" "),a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("foo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("git")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/..."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("foo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("git")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("rev")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deadbeaf"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("foo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("git")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://github.com/..."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("tag")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deadbeaf"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("These three foos are all valid, but different from each other in compilation. Assume that crate "),a("code",[t._v("bar")]),t._v(" depends on foo with the first one, and "),a("code",[t._v("haa")]),t._v(" depends on foo with the second one, then the dependency tree is going to mess up. So this is the reason that almost all forked crates are tagged with "),a("code",[t._v("sgx_1.0.9")]),t._v(" but the cross references are not using that tag.")]),t._v(" "),a("p",[t._v("One potential fix is a tool to fix Cargo.lock and remove the redundant crates. I've done this successfully by manually dedup Cargo.lock according to the hash value instead of URI. Maybe we can automate this later\"")]),t._v(" "),a("h2",{attrs:{id:"the-world-map"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-world-map"}},[t._v("#")]),t._v(" The World Map")]),t._v(" "),a("p",[t._v("Generated by "),a("code",[t._v("cargo deps")]),t._v(" on dumb-all.")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/dingelish/sgx-world/raw/master/dumb-all/world.png",alt:"world map"}})]),t._v(" "),a("h2",{attrs:{id:"security-audit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security-audit"}},[t._v("#")]),t._v(" Security audit")]),t._v(" "),a("p",[t._v("We use "),a("a",{attrs:{href:"https://github.com/RustSec/cargo-audit",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("cargo-audit")]),a("OutboundLink")],1),t._v(" to automatically check for known vulnerabilities. And the pipeline has been added to CI which runs nightly. We'll update immediately once we find a security issue by "),a("code",[t._v("cargo-audit")]),t._v(". Thanks to @tarcieri for this fantastic tool!")])])}),[],!1,null,null,null);e.default=r.exports}}]);