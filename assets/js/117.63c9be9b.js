(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{525:function(e,t,r){"use strict";r.r(t);var o=r(27),c=Object(o.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"source-code-of-the-executor"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#source-code-of-the-executor"}},[e._v("#")]),e._v(" Source Code of the Executor")]),e._v(" "),r("p",[e._v("The source code of the new executor should be at "),r("code",[e._v("executor/src/")]),e._v(".")]),e._v(" "),r("ol",[r("li",[e._v("Create a public executor unit struct.")]),e._v(" "),r("li",[e._v("Implement "),r("code",[e._v("TeaclaveExecutor")]),e._v(" trait and "),r("code",[e._v("execute")]),e._v(" function for the new struct.")]),e._v(" "),r("li",[e._v("Re-export your new executor in "),r("code",[e._v("executor/src/lib.rs")]),e._v(" to make it callable.")]),e._v(" "),r("li",[e._v("Optionally, add unit test code to test your executor, and add a line calling your test in "),r("code",[e._v("executor/src/lib.rs")]),e._v(".")])]),e._v(" "),r("h2",{attrs:{id:"extern-function"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#extern-function"}},[e._v("#")]),e._v(" Extern Function")]),e._v(" "),r("p",[e._v("Usually the new executor for other language or bytecode cannot be supported by this single rust source file,\nand the embedded execution environment is ported from another project, which can be written in another\nlanguage. Therefore some extern functions should be imported to the rust source code and a "),r("strong",[e._v("static")]),e._v(" library\nis needed in linking.")]),e._v(" "),r("p",[e._v("You may add this library in the linking command located at "),r("code",[e._v("cmake/scripts/sgx_link_sign.sh")]),e._v(", and such library\nshould be in "),r("code",[e._v("${TEACLAVE_OUT_DIR}")]),e._v(", which will be parsed to "),r("code",[e._v("build/intermediate")]),e._v(" in build phase.")]),e._v(" "),r("h1",{attrs:{id:"add-the-interface"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#add-the-interface"}},[e._v("#")]),e._v(" Add the Interface")]),e._v(" "),r("p",[e._v("You also need to add some auxillary code for teaclave and tell it when and how to invoked the new executor.")]),e._v(" "),r("h2",{attrs:{id:"types-src-worker-rs"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#types-src-worker-rs"}},[e._v("#")]),e._v(" "),r("code",[e._v("types/src/worker.rs")])]),e._v(" "),r("ol",[r("li",[e._v("Add a new enum value in "),r("code",[e._v("ExecutorType")]),e._v(";")]),e._v(" "),r("li",[e._v("Add a match case in "),r("code",[e._v("ExecutorType::try_from")]),e._v(" to get the "),r("code",[e._v("ExecutorType")]),e._v(" from a string;")]),e._v(" "),r("li",[e._v("Add a match case in "),r("code",[e._v("ExecutorType::fmt")]),e._v(" for printing;")]),e._v(" "),r("li",[e._v("Besides, add a enum in "),r("code",[e._v("Executor")]),e._v(";")]),e._v(" "),r("li",[e._v("Add match cases in "),r("code",[e._v("Executor::try_from")]),e._v(" and "),r("code",[e._v("Executor::fmt")]),e._v(" just like what you've done in step 3 and 4.")])]),e._v(" "),r("h2",{attrs:{id:"worker-src-worker-rs"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#worker-src-worker-rs"}},[e._v("#")]),e._v(" "),r("code",[e._v("worker/src/worker.rs")])]),e._v(" "),r("ol",[r("li",[e._v("Import the executor in "),r("code",[e._v("use teaclave_executor::{...}")])]),e._v(" "),r("li",[e._v("Register the new executor in "),r("code",[e._v("Worker::Default")])])]),e._v(" "),r("h1",{attrs:{id:"invoke-the-new-executor"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#invoke-the-new-executor"}},[e._v("#")]),e._v(" Invoke the New Executor")]),e._v(" "),r("p",[e._v("Just call the API and remember to set "),r("code",[e._v("executor_type")]),e._v(" to your new executor type's name (the string used in\n"),r("code",[e._v("ExecutorType::try_from")]),e._v(" match case) when calling "),r("code",[e._v("register_function")]),e._v(", and set the "),r("code",[e._v("executor")]),e._v(" to the executor's\nname correspondingly.")])])}),[],!1,null,null,null);t.default=c.exports}}]);