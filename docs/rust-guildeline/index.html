<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust Development Guideline</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.21270e76.css" as="style"><link rel="preload" href="/assets/js/app.b971afb6.js" as="script"><link rel="preload" href="/assets/js/2.be096c87.js" as="script"><link rel="preload" href="/assets/js/18.c08d6060.js" as="script"><link rel="prefetch" href="/assets/js/10.0ed35cd4.js"><link rel="prefetch" href="/assets/js/11.d64b9760.js"><link rel="prefetch" href="/assets/js/12.1934d659.js"><link rel="prefetch" href="/assets/js/13.0c9c53cb.js"><link rel="prefetch" href="/assets/js/14.315ba197.js"><link rel="prefetch" href="/assets/js/15.b879b56a.js"><link rel="prefetch" href="/assets/js/16.38dd3398.js"><link rel="prefetch" href="/assets/js/17.d593bd45.js"><link rel="prefetch" href="/assets/js/19.49b7ed52.js"><link rel="prefetch" href="/assets/js/20.45af4597.js"><link rel="prefetch" href="/assets/js/21.e4da91d8.js"><link rel="prefetch" href="/assets/js/22.3d78d106.js"><link rel="prefetch" href="/assets/js/23.6174fd9c.js"><link rel="prefetch" href="/assets/js/24.dd68e37a.js"><link rel="prefetch" href="/assets/js/25.44331c46.js"><link rel="prefetch" href="/assets/js/3.895526de.js"><link rel="prefetch" href="/assets/js/4.bdf2f8cb.js"><link rel="prefetch" href="/assets/js/5.44769256.js"><link rel="prefetch" href="/assets/js/6.820bf6f6.js"><link rel="prefetch" href="/assets/js/7.10da7632.js"><link rel="prefetch" href="/assets/js/8.550bde35.js"><link rel="prefetch" href="/assets/js/9.388dded5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.21270e76.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rust-development-guideline"><a href="#rust-development-guideline" class="header-anchor">#</a> Rust Development Guideline</h1> <p>This doc defines some guidelines for developing Teaclave in Rust.</p> <h2 id="style"><a href="#style" class="header-anchor">#</a> Style</h2> <p>We use <code>rustfmt</code> and <code>clippy</code> to format and lint all Rust code. Mostly, we use
the default configurations, but there are a couple of custom settings and lint
exceptions. The exceptions should be defined along with the code. Our CI will
check the format/lint issues and deny all warnings by default. Simply run <code>make format</code> to format all code and <code>make CLP=1</code> to lint code before submitting a PR.
If you still have some doubts of the <code>clippy</code> error, feel free to point out and
add an exception.</p> <h2 id="elegant-apis"><a href="#elegant-apis" class="header-anchor">#</a> Elegant APIs</h2> <p>Elegantly designed functions and APIs will make the project readable and
user-friendly. Basically, we follow naming conventions and API design patterns
of Rust standard library. There's no official guideline, but here are several
articles or docs for reference:</p> <ul><li><a href="https://rust-lang.github.io/api-guidelines/" target="_blank" rel="noopener noreferrer">Rust API guidelines<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/rust-unofficial/patterns" target="_blank" rel="noopener noreferrer">Rust Design Patterns<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://deterministic.space/elegant-apis-in-rust.html#what-makes-an-api-elegant" target="_blank" rel="noopener noreferrer">Elegant Library APIs in Rust<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="unsafe-rust"><a href="#unsafe-rust" class="header-anchor">#</a> Unsafe Rust</h2> <p>Using unsafe Rust is extremely dangerous, and may break Rust's strong
memory-safety guarantees. Therefore, we want to keep unsafe Rust as minimal as
possible. Sometime (very rare) using unsafe Rust can significant improve
performance, the unsafe code should <em>well documented</em> and <em>explain the
rationales</em>. For contributors and reviewers, pay attention to the unsafe code
and carefully check whether the pre-conditions and post-conditions are still
hold.</p> <h2 id="error-handling"><a href="#error-handling" class="header-anchor">#</a> Error Handling</h2> <p>Using <code>unwrap</code> or <code>expect</code> to get a value from an optional type may introduce
runtime panic. Therefore, properly using the error handling mechanism provided
by Rust can make the system robust and clean. In some cases, optional value can
never be <code>None</code> internally, <code>unwrap</code> can be used with a comment explaining the
assumptions and reasons. The same rule also applies to <code>panic</code> and similar
functions which may cause runtime panic. One exception is to use <code>unwrap</code> and
<code>expect</code> in tests, while <code>expect</code> is better because it will show a message to
help debugging.</p> <h2 id="third-party-crates"><a href="#third-party-crates" class="header-anchor">#</a> Third-Party Crates</h2> <p>To ensure the security, stability and compatibility of upstream crates, all
third-party crates (especially for ported SGX-compatible crates) used in
Teaclave are vendored in the <code>third_party</code> directory. Please refer to the
<code>crates-sgx</code> and <code>crates-io</code> repo and choose specific versions of vendored
crates.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b971afb6.js" defer></script><script src="/assets/js/2.be096c87.js" defer></script><script src="/assets/js/18.c08d6060.js" defer></script>
  </body>
</html>
